# 小学口算练习应用开发计划

## 概述
本产品是一款专为小学生设计的移动端 H5 应用，旨在提供一个简单有趣的口算练习平台。用户可以自主选择填空题或选择题模式，进行包含10道题的口算练习。题目范围涵盖加减乘除，确保所有数字不超过两位数（即0-100），且答案始终为非负整数。完成所有题目后，用户可以提交作答进行批改，系统将即时反馈结果，并显示正确答案。批改后，用户的答案将被锁定，不能修改。用户可以通过"再来一次"功能，重新开始新一轮的练习。

## 1. 项目设置
- [x] 确认 SvelteKit 开发环境已按预期配置完毕。
- [x] 初始化 Svelte stores 用于全局状态管理 (例如：游戏状态、题目数据、用户答案)。

## 2. 核心逻辑开发 (题目生成与管理)
- **数据结构定义**
  - [x] 定义题目对象结构 (例如: `id`, `text`, `type` ('fill-in'/'multiple-choice'), `num1`, `operator`, `num2`, `correctAnswer`, `options` (for multiple-choice), `userAnswer`, `isCorrect`)。
- **题目生成模块 (`src/lib/questionGenerator.js` 或类似)**
  - [x] 实现随机数生成函数，确保数字在 0-100 范围内。
  - [x] 实现加法题目生成函数。
    - 确保操作数和结果符合要求。
  - [x] 实现减法题目生成函数。
    - 确保被减数大于等于减数，结果非负。
  - [x] 实现乘法题目生成函数。
    - 确保操作数和结果符合要求 (积不大于100，或者操作数限制使得积自然不超范围，需根据PRD细化)。
  - [x] 实现除法题目生成函数。
    - 确保被除数能被除数整除，除数不为0，结果非负。
  - [x] 实现主题目生成函数，能够:
    - 根据所选类型（加减乘除混合）生成指定数量（10道）的题目。
    - 确保题目不重复（或基本不重复）。
  - [x] (选择题) 实现干扰项生成函数：
    - 为给定的正确答案生成3个唯一的、合理的、非负整数干扰选项。
    - 确保干扰项与正确答案不同。
  - [x] 实现根据用户选择（填空/选择）包装题目数据的函数。
    - 如果是选择题，则调用干扰项生成函数并组合选项。

## 3. 前端开发 (UI 与交互)
- **基础组件**
  - [x] 创建 `Button.svelte` 组件 (若通用样式)。
- **页面与流程组件 (`src/routes/`)**
  - **起始页面 (`+page.svelte`)**
    - [x] 显示标题和"开始"按钮。
    - [x] 点击"开始"按钮后，导航到题目类型选择。
  - **题目类型选择**
    - [x] 创建选择界面 (例如，模态框或新页面 `src/routes/select-type/+page.svelte`)。
    - [x] 提供"填空题"和"选择题"选项。
    - [x] 选择后，存储选择并触发题目生成，然后导航到答题界面。
  - **答题界面 (`src/routes/quiz/+page.svelte`)**
    - [x] **题目显示组件 (`QuestionDisplay.svelte`)**
      - [x] 根据题目数据显示题目文本 (例如 "15 + 23 = __" 或 "5 x 8 = ?")。
    - [x] **填空题输入组件 (`FillInBlankInput.svelte`)**
      - [x] 提供数字输入框。
      - [x] 将用户输入存储到对应的题目对象中。
    - [x] **选择题选项组件 (`MultipleChoiceOptions.svelte`)**
      - [x] 显示4个选项按钮。
      - [x] 处理用户选择，高亮选中项，并将选择存储到对应的题目对象中。
    - [x] **答题主逻辑**
      - [x] 从 Svelte store 获取当前题目列表。
      - [x] 逐个展示题目 (例如，每次一道，通过"下一题"按钮切换，或直接渲染10道题列表)。
      - [x] 管理当前题目索引。
      - [x] 当所有题目（10道）回答完毕或用户选择提交时，显示"判题"按钮。
  - **判题逻辑与结果展示**
    - [x] **判题功能 (`src/lib/grading.js` 或在 Svelte store 中实现)**
      - [x] 遍历用户答案，与正确答案比较，更新每道题的 `isCorrect` 状态。
      - [x] 计算总得分。
    - [x] **结果展示界面 (`src/routes/results/+page.svelte`)**
      - [x] 点击"判题"按钮后，执行判题逻辑并导航到此页面。
      - [x] 显示总体得分 (例如 "8/10 正确")。
      - [x] 列表展示每道题：题目、用户答案、正确答案，并标示对错。
      - [x] 对于错误的题目，清晰展示正确答案。
      - [x] 确保在此阶段用户答案不可再编辑。
    - [x] **"再来一次"功能**
      - [x] 在结果页面提供"再来一次"按钮。
      - [x] 点击后，重置游戏状态 (清空题目、答案，回到初始状态或题目类型选择)。

## 4. 状态管理与集成
- [x] **Svelte Stores (`src/lib/stores.js` 或类似)**
  - [x] `gameModeStore`: (e.g., 'initial', 'typeSelection', 'quiz', 'results')。
  - [x] `questionTypeStore`: ('fill-in', 'multiple-choice')。
  - [x] `questionsStore`: 存储当前生成的10道题目对象数组。
  - [x] `userAnswersStore`: (或者直接在 `questionsStore` 的每个题目对象中存储用户答案)。
  - [x] `scoreStore`: 存储判题后的得分。
- **逻辑集成**
  - [x] 将题目生成逻辑连接到题目类型选择后的流程。
  - [x] 将用户在UI上的作答实时/批量更新到 Svelte store。
  - [x] "判题"按钮触发判题逻辑，并将结果存入 store。
  - [x] 结果页面从 store 读取数据进行展示。
  - [x] "再来一次"按钮重置相关 stores 并引导用户重新开始。

## 5. 测试
- **核心逻辑单元测试 (例如使用 Vitest)**
  - [x] 测试 `questionGenerator.js`：
    - [x] 各种题目类型的生成是否符合约束（数字范围、答案非负、除法整除等）。
    - [x] 选择题选项生成是否正确（一个正确答案，三个不同干扰项）。
  - [x] 测试 `grading.js`：
    - [x] 判题逻辑是否准确。
- **组件交互测试 (例如使用 Svelte Testing Library / Playwright)**
  - [x] 测试用户选择题目类型流程。
  - [x] 测试用户答题（填空和选择）并能正确记录答案。
  - [x] 测试判题后结果展示是否正确。
  - [x] 测试答案锁定功能。
  - [x] 测试"再来一次"功能是否能重置流程。

## 6. 文档
- [x] 为 `questionGenerator.js` 和 `grading.js` 中的复杂函数添加必要的代码注释。
- [x] 更新 `README.md` 说明如何运行和构建项目。

## 7. 部署 (基本)
- [x] 编写构建命令 (`npm run build`)。
- [x] (可选) 简单说明如何将 `build` 目录部署到静态托管平台。

## 8. 维护 (基本)
- [x] 建立一个简单的方式来记录和跟踪发现的BUG。

此计划优先处理核心的游戏流程，简化了非核心功能。 